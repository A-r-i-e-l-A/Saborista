<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saborista.net - Perfil</title>
    <link rel="stylesheet" href="CSS/style.css">
    <link rel="stylesheet" href="CSS/perfil.css">
    <script src="JS/script.js" defer></script>
</head>

<body>
    <header>
        <nav>
            <img src="imagenes/FotoLogo.png" alt="Logo">
            <ul>
                <li><a href="home.html">Inicio</a></li>
                <li><a href="recetas.html">Recetas</a></li>
                <li id="addRecipeLink" style="display: none;"><a href="añadir_receta.html">Añadir Receta</a></li>
                <li id="loginLink"><a href="iniciar_sesion.html">Iniciar Sesión</a></li>
                <li id="registerLink"><a href="registro.html">Registrarse</a></li>
                <li id="profileLink" style="display: none;"><a href="perfil.html"><img src="Imagenes/user.png"
                            alt="Perfil"></a></li>
            </ul>
        </nav>
    </header>
    <h1>Perfil</h1>
    <div id="userInfo">
        <!-- User information will be displayed here -->
    </div>

    <script>
        // Check if the user cookie exists
        const userCookieProfile = document.cookie.split(';').find(cookie => cookie.trim().startsWith('user='));

        if (userCookieProfile) {
            // If the user cookie exists, show the "Añadir Receta" link and hide login and registration links
            document.getElementById('addRecipeLink').style.display = 'block';
            document.getElementById('loginLink').style.display = 'none';
            document.getElementById('registerLink').style.display = 'none';

            // Fetch user information from the server
            fetch('/getUserInfo', {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': userCookieProfile, // Send the user cookie as Authorization header
                },
            })
                .then(response => response.json())
                .then(data => {
                    // Display user information
                    document.getElementById('userInfo').innerHTML = `
                    <ul>
                        <li><strong>Usuario:</strong> ${data.username}</li>
                        <li><strong>Contraseña:</strong> ${data.password}</li>
                        <li><strong>isAdmin:</strong> ${data.isAdmin}</li>
                    </ul>`;
                })
                .catch(error => console.error('Error fetching user information:', error));
        }
    </script>
</body>

</html>